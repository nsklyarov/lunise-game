window.__require=function e(t,o,n){function i(s,c){if(!o[s]){if(!t[s]){var a=s.split("/");if(a=a[a.length-1],!t[a]){var l="function"==typeof __require&&__require;if(!c&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+s+"'")}s=a}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return i(t[s][1][e]||e)},u,u.exports,e,t,o,n)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)i(n[s]);return i}({BoosterNode:[function(e,t,o){"use strict";cc._RF.push(t,"564a8ymAllJpLTWTVX7tnqo","BoosterNode");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../utils/Event"),c=cc._decorator,a=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.count=null,t.boosterIcon=null,t.icons=new Array,t.onActivateBooster=new s.Event,t}return i(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._booster.type},enumerable:!1,configurable:!0}),t.prototype.setBooster=function(e){var t=this;(null==e?void 0:e.type)&&(this._booster=e,this.boosterIcon.spriteFrame=this.icons[e.type-1],this.count.string=""+e.count,e.onChangeCount.add(this.node,function(){t._changeCount()}))},t.prototype.addBoosterButton=function(){this._booster.count<=0||this.onActivateBooster.dispatch(this._booster.type)},t.prototype._changeCount=function(){this.count.string=""+this._booster.count},r([l(cc.Label)],t.prototype,"count",void 0),r([l(cc.Sprite)],t.prototype,"boosterIcon",void 0),r([l([cc.SpriteFrame])],t.prototype,"icons",void 0),r([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../utils/Event":"Event"}],ConditionalNode:[function(e,t,o){"use strict";cc._RF.push(t,"fe0314hMk1NqKP+F90s4UI0","ConditionalNode");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=cc._decorator,c=s.ccclass,a=s.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.moves=null,t.goals=null,t.reshuffle=null,t.progressMoves=null,t.progressGoals=null,t._conditional=null,t}return i(t,e),t.prototype.setConditional=function(e){var t=this;this._conditional=e,this._conditional.onChange.add(this.node,function(){return t._updateProgress()}),this._updateProgress()},t.prototype._updateProgress=function(){this.moves.string=this._conditional.moves+"/"+this._conditional.movesBase,this.goals.string=this._conditional.goals+"/"+this._conditional.goalsBase,this.reshuffle.string=""+this._conditional.reshuffleCount,this.progressMoves.progress=this._conditional.moves/this._conditional.movesBase,this.progressGoals.progress=this._conditional.goals/this._conditional.goalsBase},r([a(cc.Label)],t.prototype,"moves",void 0),r([a(cc.Label)],t.prototype,"goals",void 0),r([a(cc.Label)],t.prototype,"reshuffle",void 0),r([a(cc.ProgressBar)],t.prototype,"progressMoves",void 0),r([a(cc.ProgressBar)],t.prototype,"progressGoals",void 0),r([c],t)}(cc.Component);o.default=l,cc._RF.pop()},{}],Conditional:[function(e,t,o){"use strict";cc._RF.push(t,"f9debaWwadKBJM80gkc81WN","Conditional"),Object.defineProperty(o,"__esModule",{value:!0}),o.Conditional=o.EndType=void 0;var n,i=e("../Global"),r=e("../utils/Event");(function(e){e[e.Lose=0]="Lose",e[e.Win=1]="Win"})(n=o.EndType||(o.EndType={}));var s=function(){function e(){this._goals=0,this._moves=0,this._reshuffleCountWithEnd=0,this.onChange=new r.Event,this.onEnd=new r.Event;var e=i.default.config;this._goals=e.conditional.goals,this._moves=e.conditional.moves,this._reshuffleCountWithEnd=e.reshuffleCountWithEndGame}return Object.defineProperty(e.prototype,"goals",{get:function(){return Math.max(this._goals,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"moves",{get:function(){return Math.max(this._moves,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reshuffleCount",{get:function(){return Math.max(this._reshuffleCountWithEnd,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"goalsBase",{get:function(){return i.default.config.conditional.goals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"movesBase",{get:function(){return i.default.config.conditional.moves},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reshuffleCountBase",{get:function(){return i.default.config.reshuffleCountWithEndGame},enumerable:!1,configurable:!0}),e.prototype.changeConditional=function(e){this._checkConditional()&&(this._moves--,this._goals-=e,this._checkEnd())},e.prototype.decrementReshuffleCount=function(){this._reshuffleCountWithEnd--,this._checkEnd()},e.prototype._checkEnd=function(){this.onChange.dispatch(),0==this.goals?this.onEnd.dispatch(n.Win):0!=this.moves&&0!=this.reshuffleCount||this.onEnd.dispatch(n.Lose)},e.prototype._checkConditional=function(){return this._moves>0&&this._goals>0},e}();o.Conditional=s,cc._RF.pop()},{"../Global":"Global","../utils/Event":"Event"}],Config:[function(e,t,o){"use strict";cc._RF.push(t,"ee3b5CUuHFIiaEvXO9TLZMT","Config"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./model/Tile");o.default=function(){this.gridSize=cc.v2(6,6),this.boosterRandomTilesCount=4,this.boosterMegaBombTilesCount=9,this.listBoosterTilesCount=[this.boosterRandomTilesCount,this.boosterMegaBombTilesCount],this.simpleBoostersList=[n.TileState.Horizontal,n.TileState.Vertical,n.TileState.Bomb],this.bombRadius=1,this.speedAnimation=1,this.conditional={moves:10,goals:30},this.reshuffleCountWithEndGame=3,this.defaultBoostersCountForGame=5,this.inventoryBoostersList=[n.TileState.Bomb,n.TileState.RemoveAll],this.transitionBetweenScenesTime=.6},cc._RF.pop()},{"./model/Tile":"Tile"}],EndNode:[function(e,t,o){"use strict";cc._RF.push(t,"297c7L+rrhEJ7QCi1ybbl6/","EndNode");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../model/Conditional"),c=e("../../utils/Event"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.text=null,t.onExit=new c.Event,t}return i(t,e),t.prototype.setEndType=function(e){this.text.string=e==s.EndType.Lose?"\u041f\u0440\u043e\u0438\u0433\u0440\u0430\u043b":"\u041f\u043e\u0431\u0435\u0434\u0430"},t.prototype.exitButton=function(){this.onExit.dispatch()},r([u(cc.Label)],t.prototype,"text",void 0),r([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../model/Conditional":"Conditional","../../utils/Event":"Event"}],Event:[function(e,t,o){"use strict";cc._RF.push(t,"859c3Pk9eJB14dfecix7foH","Event"),Object.defineProperty(o,"__esModule",{value:!0}),o.Event=o.EventHandler=void 0;var n=function(){function e(e,t,o){void 0===o&&(o=!1),this.once=o,this.owner=null,this.isComponent=!1,this.cbOnEvent=null,this.owner=e,this.cbOnEvent=t,this.isComponent=e instanceof cc.Component}return e.prototype.onEvent=function(e){this.cbOnEvent(e)},e}();o.EventHandler=n;var i=function(){function e(){this.handlers=new Array}return e.prototype.add=function(e,t){var o=e instanceof n?e:new n(e,t);if(e instanceof cc.Component){var i=e.__etr;if(null==i){e.__etr=new Set([this]);var r=e.onDestroy;e.onDestroy=function(){e.__etr.forEach(function(t){return t.removeAll(e)}),e.isValid&&r&&r.call(e)}}else i.add(this)}this.handlers.push(o)},e.prototype.replace=function(e,t){this.removeAll(e),this.add(e,t)},e.prototype.dispatch=function(e){return this.handlers.filter(function(e){return!e.isComponent||null!=e.owner.node&&e.owner.node.isValid}),this.handlers.forEach(function(t){return t.onEvent(e)}),this.handlers=this.handlers.filter(function(e){return 0==e.once}),!0},e.prototype.remove=function(e){this.handlers=this.handlers.filter(function(t){return t!=e})},e.prototype.removeAll=function(e){this.handlers=e?this.handlers.filter(function(t){return t.owner!=e}):[]},e.prototype.once=function(e){var t=this,o=new n(this,function(n){t.remove(o),e(n)});this.add(o)},e.once=function(e,t){var o=new n(this,function(n){e.remove(o),t(n)});e.add(o)},e}();o.Event=i,cc._RF.pop()},{}],Game:[function(e,t,o){"use strict";cc._RF.push(t,"b6fe4968jBM1qCrCaQcem5K","Game");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.Game=void 0;var s=e("../nodes/GridNode"),c=e("../nodes/ConditionalNode"),a=e("../nodes/InventoryBoostersNode"),l=e("../../model/Grid"),u=e("../../model/Conditional"),p=e("../../model/InventoryBoosters"),f=e("../nodes/EndNode"),d=e("../nodes/BoosterNode"),h=e("../../Global"),y=e("./SceneType"),_=cc._decorator,v=_.ccclass,g=_.property,b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gridView=null,t.conditionalView=null,t.inventoryBoosterView=null,t.blackScreen=null,t.chooseBoosterScreen=null,t.endPrefab=null,t.newGame=function(){return new Promise(function(e){t._grid=new l.Grid,t._conditional=new u.Conditional,t._inventoryBoosters=new p.InventoryBoosters,t._subscrubeModelEvent(),t._initView(),t._subscrubeViewEvent(),e()})},t}return i(t,e),t.prototype.onLoad=function(){var e=this;this.blackScreen.active=!0,this.chooseBoosterScreen.active=!1,this.newGame().then(function(){cc.tween(e.blackScreen).to(h.default.config.transitionBetweenScenesTime,{opacity:0}).call(function(){return e.blackScreen.active=!1}).start()})},t.prototype.onExitSelectBooster=function(){this.chooseBoosterScreen.active=!1,this.inventoryBoosterView.disableBooster(),this._grid.removeBlock()},t.prototype._reshuffleGrid=function(){this._grid.reshuffleGridIfNeeded(!0),this.gridView.reshuffleChange()},t.prototype._subscrubeModelEvent=function(){var e=this;this._grid.onChangeGrid.add(this.node,function(t){var o=t.removedTiles?t.removedTiles.length:0;e._conditional.changeConditional(o)}),this._grid.onNoMoves.add(this.node,function(){e._conditional.decrementReshuffleCount()}),this._grid.onAddBooster.add(this.node,function(t){e._inventoryBoosters.decremenBoosterCount(t.state)}),this._conditional.onEnd.add(this.node,function(t){var o=cc.instantiate(e.endPrefab);o.getComponent(f.default).setEndType(t),o.getComponent(f.default).onExit.replace(e.node,function(){var t=cc.tween(o).by(.1,{scale:.1}).to(.2,{scale:0}).start(),n=cc.tween(e.blackScreen).to(h.default.config.transitionBetweenScenesTime,{opacity:255}).call(function(){return cc.director.loadScene(y.SceneType.Menu)}).start();cc.tween(e.blackScreen).sequence(t,cc.tween(e.blackScreen).delay(.2),n)}),e.blackScreen.active=!0,e.blackScreen.opacity=200,e.blackScreen.addChild(o)})},t.prototype._initView=function(){var e=this;this.gridView.createGrid(this._grid).then(function(){e.gridView.onAnimationCompleted.add(e.node,function(t){if(e.chooseBoosterScreen.active=e._grid.isSelectBooster,e._grid.isSelectBooster||e.inventoryBoosterView.disableBooster(),t)e._reshuffleGrid();else{if(e._grid.isSelectBooster)return;e._grid.removeBlock()}})}),this.conditionalView.setConditional(this._conditional),this.inventoryBoosterView.setInventory(this._inventoryBoosters)},t.prototype._subscrubeViewEvent=function(){var e=this;this.inventoryBoosterView.boosters.children.forEach(function(t){t.getComponent(d.default).onActivateBooster.replace(e.node,function(t){e.chooseBoosterScreen.active=!0,e._grid.waitTileSelectionBooster(t),e.inventoryBoosterView.selectBooster(t)})})},r([g(s.default)],t.prototype,"gridView",void 0),r([g(c.default)],t.prototype,"conditionalView",void 0),r([g(a.default)],t.prototype,"inventoryBoosterView",void 0),r([g(cc.Node)],t.prototype,"blackScreen",void 0),r([g(cc.Node)],t.prototype,"chooseBoosterScreen",void 0),r([g(cc.Prefab)],t.prototype,"endPrefab",void 0),r([v],t)}(cc.Component);o.Game=b,cc._RF.pop()},{"../../Global":"Global","../../model/Conditional":"Conditional","../../model/Grid":"Grid","../../model/InventoryBoosters":"InventoryBoosters","../nodes/BoosterNode":"BoosterNode","../nodes/ConditionalNode":"ConditionalNode","../nodes/EndNode":"EndNode","../nodes/GridNode":"GridNode","../nodes/InventoryBoostersNode":"InventoryBoostersNode","./SceneType":"SceneType"}],Global:[function(e,t,o){"use strict";cc._RF.push(t,"8e27fvX16xLorndu8adH3E2","Global"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Config"),i=function(){function e(){this.config=new n.default}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"config",{get:function(){return e.instance.config},enumerable:!1,configurable:!0}),e}();o.default=i,cc._RF.pop()},{"./Config":"Config"}],GridNode:[function(e,t,o){"use strict";cc._RF.push(t,"83aa8KWQspJ65RaR03M1Fpk","GridNode");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))(function(i,r){function s(e){try{a(n.next(e))}catch(t){r(t)}}function c(e){try{a(n.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,c)}a((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var o,n,i,r,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(e){return function(t){return a([e,t])}}function a(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){s.label=r[1];break}if(6===r[0]&&s.label<i[1]){s.label=i[1],i=r;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(r);break}i[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=e("../../model/Grid"),l=e("./TileNode"),u=e("../../utils/Event"),p=cc._decorator,f=p.ccclass,d=p.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tilePrefab=null,t.tiles=null,t.onAnimationCompleted=new u.Event,t._grid=null,t._tileSize=0,t}return i(t,e),t.prototype.getTileNode=function(e){return this.tiles.children.find(function(t){var o=t.getComponent(l.default);return o.tile.pos.x==e.pos.x&&o.tile.pos.y==e.pos.y}).getComponent(l.default)},t.prototype.createGrid=function(e){return s(this,void 0,void 0,function(){var t=this;return c(this,function(o){switch(o.label){case 0:return this._tileSize=this.tilePrefab.data.getContentSize().width,this._grid=e,[4,this._grid.board.forEach(function(e){return e.forEach(function(e){return t.createTile(e)})})];case 1:return o.sent(),this._grid.onChangeGrid.add(this.node,function(e){return t.changeGrid(e)}),this._grid.onAddBooster.add(this.node,function(e){return t.changeTile(e)}),[2]}})})},t.prototype.createTile=function(e){var t=cc.instantiate(this.tilePrefab);t.getComponent(l.default).setTileInfo(e),t.setPosition(e.pos.y*this._tileSize,-e.pos.x*this._tileSize),this.tiles.addChild(t)},t.prototype.changeGrid=function(e){e.type==a.GridChangesType.Simple?this.simpleChange(e):this.boosterChange(e)},t.prototype.changeTile=function(e){this.getTileNode(e).updateTileIconAnimation(),this.onAnimationCompleted.dispatch()},t.prototype.simpleChange=function(e){return s(this,void 0,void 0,function(){var t=this;return c(this,function(o){switch(o.label){case 0:return[4,Promise.all(e.removedTiles.map(function(e){return t.getTileNode(e).removeAnimation()}))];case 1:return o.sent(),e.activeTile.isBooster?[4,this.getTileNode(e.activeTile).createBombAnimation()]:[3,3];case 2:o.sent(),o.label=3;case 3:return[4,Promise.all(e.dropTiles.map(function(e){return t.getTileNode(e).dropAnimation()}))];case 4:return o.sent(),[4,Promise.all(e.removedTiles.map(function(e){return t.getTileNode(e).updateRemoveTileAnimation()}))];case 5:return o.sent(),[4,this.onAnimationCompleted.dispatch(e.reshuffle)];case 6:return o.sent(),[2]}})})},t.prototype.boosterChange=function(e){return s(this,void 0,void 0,function(){var t=this;return c(this,function(o){switch(o.label){case 0:return[4,Promise.all(e.removedTiles.map(function(e){return t.getTileNode(e).removeAnimation()}))];case 1:return o.sent(),[4,Promise.all(e.dropTiles.map(function(e){return t.getTileNode(e).dropAnimation()}))];case 2:return o.sent(),[4,Promise.all(e.removedTiles.map(function(e){return t.getTileNode(e).updateRemoveTileAnimation()}))];case 3:return o.sent(),[4,this.onAnimationCompleted.dispatch(e.reshuffle)];case 4:return o.sent(),[2]}})})},t.prototype.reshuffleChange=function(){return s(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,Promise.all(this.tiles.children.map(function(e){return e.getComponent(l.default).reshuffleAnimation()}))];case 1:return e.sent(),[4,this.onAnimationCompleted.dispatch()];case 2:return e.sent(),[2]}})})},r([d(cc.Prefab)],t.prototype,"tilePrefab",void 0),r([d(cc.Node)],t.prototype,"tiles",void 0),r([f],t)}(cc.Component);o.default=h,cc._RF.pop()},{"../../model/Grid":"Grid","../../utils/Event":"Event","./TileNode":"TileNode"}],GridRemover:[function(e,t,o){"use strict";cc._RF.push(t,"ebbe4af39FH7qL3apjkpOlx","GridRemover"),Object.defineProperty(o,"__esModule",{value:!0}),o.ReshuffleStrategy=o.SuperBombStrategy=o.BombStrategy=o.VerticalStrategy=o.HorizontalStrategy=o.SimpleStrategy=void 0;var n=e("../Global"),i=function(){function e(){console.log("Simple Strategy")}return e.prototype.getRemoveTiles=function(e){return e.remove(),[e]},e}();o.SimpleStrategy=i;var r=function(){function e(){console.log("Horizontal Strategy")}return e.prototype.getRemoveTiles=function(e,t){e.remove();for(var o=[e],n=0;n<t.rowsCount;n++){var i=t.board[e.pos.x][n];console.log("2 error occur"),i.isNormal&&(o=o.concat(i.getRemoveStrategy.getRemoveTiles(i,t)))}return o},e}();o.HorizontalStrategy=r;var s=function(){function e(){console.log("Vertical Strategy")}return e.prototype.getRemoveTiles=function(e,t){e.remove();for(var o=[e],n=0;n<t.columnCount;n++){var i=t.board[n][e.pos.y];console.log("3 error occur"),i.isNormal&&(o=o.concat(i.getRemoveStrategy.getRemoveTiles(i,t)))}return o},e}();o.VerticalStrategy=s;var c=function(){function e(){console.log("Bomb Strategy")}return e.prototype.getRemoveTiles=function(e,t){e.remove();for(var o=[e],i=n.default.config.bombRadius,r=e.pos.x-i;r<=e.pos.x+i;r++)for(var s=e.pos.y-i;s<=e.pos.y+i;s++){var c=t.board[r][s];t.isValidPick(cc.v2(r,s))&&c.isNormal&&(console.log("4 error occur"),o=o.concat(c.getRemoveStrategy.getRemoveTiles(c,t)))}return o},e}();o.BombStrategy=c;var a=function(){function e(){console.log("SuperBomb Strategy")}return e.prototype.getRemoveTiles=function(e,t){return t.listTiles.forEach(function(e){return e.remove()}),t.listTiles},e}();o.SuperBombStrategy=a;var l=function(){function e(){console.log("ReshuffleStrategy Strategy")}return e.prototype.getRemoveTiles=function(e,t){e.remove();var o=[e];return t.reshuffleGridIfNeeded(!0),o},e}();o.ReshuffleStrategy=l,cc._RF.pop()},{"../Global":"Global"}],Grid:[function(e,t,o){"use strict";cc._RF.push(t,"57ad3Qu2klNka+vx5D8mzuT","Grid"),Object.defineProperty(o,"__esModule",{value:!0}),o.Grid=o.GridChangesInfo=o.GridChangesType=o.GridState=void 0;var n,i,r=e("./Tile"),s=e("../utils/Event"),c=e("../utils/Utils"),a=e("../Global");(function(e){e[e.NotReady=0]="NotReady",e[e.Ready=1]="Ready",e[e.Move=2]="Move",e[e.FullStop=3]="FullStop",e[e.SelectBooster=4]="SelectBooster"})(n=o.GridState||(o.GridState={})),function(e){e[e.None=0]="None",e[e.Simple=1]="Simple",e[e.Booster=2]="Booster",e[e.Reshuffle=3]="Reshuffle"}(i=o.GridChangesType||(o.GridChangesType={}));var l=function(){this.type=i.None};o.GridChangesInfo=l;var u=function(){function e(){var e=this;this._size=null,this._board=[],this._connectedTilesArray=[],this._state=n.NotReady,this._gridChanges=new l,this._waitSelectBoosterType=null,this._reshuffleActivate=!1,this.onChangeGrid=new s.Event,this.onNoMoves=new s.Event,this.onAddBooster=new s.Event,this.isValidPick=function(t){var o;return null!=(null===(o=e._board[t.x])||void 0===o?void 0:o[t.y])},this._isCheckTile=function(t){return null!=e._connectedTilesArray.find(function(e){return e.pos.x===t.pos.x&&e.pos.y===t.pos.y})},this._size=a.default.config.gridSize,this._addTiles()}return Object.defineProperty(e.prototype,"rowsCount",{get:function(){return this._size.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){return this._size.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"board",{get:function(){return this._board},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listTiles",{get:function(){var e=[];return this._board.forEach(function(t){return e=e.concat(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlock",{get:function(){return this._state==n.Move||this._state==n.FullStop},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelectBooster",{get:function(){return this._state==n.SelectBooster},enumerable:!1,configurable:!0}),e.prototype.removeBlock=function(){this._state=n.Ready},e.prototype.reshuffleGridIfNeeded=function(e){var t=this;if(void 0===e&&(e=!1),this._needReshuffle()||e){var o=[];this._board.forEach(function(e){return o=o.concat(e)}),c.shuffle(o);var n=c.chunkArray(o,this._size.x);this._board=n,function(){for(var e=0;e<t._size.x;e++)for(var o=0;o<t._size.y;o++)t._board[e][o].updatePos(cc.v2(e,o))}(),this.reshuffleGridIfNeeded()}},e.prototype.waitTileSelectionBooster=function(e){this._state=n.SelectBooster,this._waitSelectBoosterType=e},e.prototype.logBoard=function(){if(this._board){for(var e=[],t=0;t<this._size.x;t++){e.push([]);for(var o=0;o<this._size.y;o++)e[t].push([this._board[t][o].state,this._board[t][o].pos.x,this._board[t][o].pos.y])}cc.log("")}},e.prototype._addTiles=function(){for(var e=this,t=0;t<this._size.x;t++){this._board.push([]);for(var o=function(o){var s=new r.Tile(cc.v2(t,o));s.onAction.add(i,function(){if(!e.isBlock){if(e.isSelectBooster)return e._state=n.Move,void e._selectBooster(s);e._state=n.Move,e._changeGrid(s)}}),i._board[t].push(s)},i=this,s=0;s<this._size.y;s++)o(s)}this.reshuffleGridIfNeeded()},e.prototype._needReshuffle=function(){for(var e=0;e<this._size.x;e++)for(var t=0;t<this._size.y;t++){var o=cc.v2(e,t);if(this._getListConnectedTiles(o).length>1||this._getTile(o).isBooster)return!1}return!0},e.prototype._getTile=function(e){return this._board[e.x][e.y]},e.prototype._getListConnectedTiles=function(e){this._connectedTilesArray=[];var t=this._getTile(e).state;return this._findConnectedTiles(e,t),this._connectedTilesArray},e.prototype._removeTiles=function(e){var t=this,o=[];return this._getListConnectedTiles(e.pos).forEach(function(e){var n=t._getTile(e.pos).getRemoveStrategy;n&&(o=o.concat(n.getRemoveTiles(e,t)))}),o},e.prototype._dropTiles=function(){for(var e=[],t=this.rowsCount-2;t>=0;t--)for(var o=0;o<this.columnCount;o++){var n=this._emptySpacesBelow(t,o),i=this._getTile(cc.v2(t,o));i.isNormal&&n>0&&(e.push(i),this._swapTile(i.pos,cc.v2(t+n,o)))}return e},e.prototype._fillGrid=function(){for(var e=0;e<this.columnCount;e++)if(this._board[0][e].isRemoved)for(var t=this._emptySpacesBelow(0,e)+1,o=0;o<t;o++)this._board[o][e].updateState()},e.prototype._findConnectedTiles=function(e,t){if(this.isValidPick(e)){var o=this._getTile(e);o.isRemoved||o.state!=t||this._isCheckTile(o)||(this._connectedTilesArray.push(o),this._findConnectedTiles(cc.v2(e.x+1,e.y),t),this._findConnectedTiles(cc.v2(e.x-1,e.y),t),this._findConnectedTiles(cc.v2(e.x,e.y+1),t),this._findConnectedTiles(cc.v2(e.x,e.y-1),t))}},e.prototype._emptySpacesBelow=function(e,t){var o=0;if(e!=this.rowsCount)for(var n=e+1;n<this.rowsCount;n++)this._getTile(cc.v2(n,t)).isRemoved&&o++;return o},e.prototype._swapTile=function(e,t){var o=this,n=function(e,t){o._board[e.x][e.y]=t,o._board[e.x][e.y].updatePos(cc.v2(e.x,e.y))},i=Object.assign(this._getTile(e));n(e,this._getTile(t)),n(t,i)},e.prototype._createBomb=function(e,t){var o=a.default.config.listBoosterTilesCount;t<Math.min.apply(Math,o)||e.createBomb(function(e){if(e>=a.default.config.boosterMegaBombTilesCount)return r.TileState.RemoveAll;if(e>=a.default.config.boosterReshuffleTilesCount)return r.TileState.Reshuffle;var t=a.default.config.simpleBoostersList;return t[c.randomInteger(0,t.length-1)]}(t))},e.prototype._changeGrid=function(e){if(e.isBooster||this._canMakeMove(e)){var t=e.isBooster?i.Booster:i.Simple;this._gridChanges.type=t,this._gridChanges.activeTile=e,this._gridChanges.removedTiles=this._removeTiles(e),t!=i.Booster&&this._createBomb(e,this._gridChanges.removedTiles.length),this._gridChanges.dropTiles=this._dropTiles(),this._fillGrid();var o=this._needReshuffle();(o||this._reshuffleActivate)&&(o&&this.onNoMoves.dispatch(),this._gridChanges.reshuffle=!0),this.onChangeGrid.dispatch(this._gridChanges),this._gridChanges=new l}},e.prototype._canMakeMove=function(e){var t=this._getListConnectedTiles(e.pos).length>1;return t||(e.onNoCombo.dispatch(),this._state=n.Ready),t},e.prototype._selectBooster=function(e){this._getTile(e.pos).state=this._waitSelectBoosterType,this._state=n.Ready,this._waitSelectBoosterType=null,this.onAddBooster.dispatch(e)},e}();o.Grid=u,cc._RF.pop()},{"../Global":"Global","../utils/Event":"Event","../utils/Utils":"Utils","./Tile":"Tile"}],InventoryBoostersNode:[function(e,t,o){"use strict";cc._RF.push(t,"ae85eA6OzFAU5CjNlpPNVXQ","InventoryBoostersNode");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./BoosterNode"),c=cc._decorator,a=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boosters=null,t}return i(t,e),t.prototype.setInventory=function(e){this.boosters.children.forEach(function(t,o){t.getComponent(s.default).setBooster(e.boosters[o])})},t.prototype.selectBooster=function(e){var t=this.boosters.children.find(function(t){return t.getComponent(s.default).type==e});this.boosters.children.forEach(function(e){return e.scale=1}),t.scale=1.1},t.prototype.disableBooster=function(){this.boosters.children.forEach(function(e){return e.scale=1})},r([l(cc.Node)],t.prototype,"boosters",void 0),r([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"./BoosterNode":"BoosterNode"}],InventoryBoosters:[function(e,t,o){"use strict";cc._RF.push(t,"66825zoe6VAGa1CfCYUuTC+","InventoryBoosters"),Object.defineProperty(o,"__esModule",{value:!0}),o.InventoryBoosters=o.Booster=void 0;var n=e("../Global"),i=e("../utils/Event"),r=function(){function e(){this.count=0,this.onChangeCount=new i.Event}return e.prototype.decremenBoosterCount=function(){this.count--,this.onChangeCount.dispatch(this.type)},e}();o.Booster=r;var s=function(){function e(){var e=this;this._inventory=[],this.onChangeInventory=new i.Event;var t=n.default.config;t.inventoryBoostersList.forEach(function(o){var n=new r;n.type=o,n.count=t.defaultBoostersCountForGame,e._inventory.push(n)})}return Object.defineProperty(e.prototype,"boosters",{get:function(){return this._inventory},enumerable:!1,configurable:!0}),e.prototype.decremenBoosterCount=function(e){this._findBooster(e).decremenBoosterCount()},e.prototype._findBooster=function(e){return this._inventory.find(function(t){return t.type==e})},e}();o.InventoryBoosters=s,cc._RF.pop()},{"../Global":"Global","../utils/Event":"Event"}],Load:[function(e,t,o){"use strict";cc._RF.push(t,"a5b38JCmwpNQrsSmFYGmPs9","Load");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../Global"),c=e("./SceneType"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blackScreen=null,t}return i(t,e),t.prototype.start=function(){this._init().then(function(){cc.director.loadScene(c.SceneType.Menu)})},t.prototype._init=function(){var e=this;return new Promise(function(t){cc.director.preloadScene(c.SceneType.Menu),setTimeout(function(){cc.tween(e.blackScreen).to(s.default.config.transitionBetweenScenesTime,{opacity:255}).call(t).start()},1e3)})},r([u(cc.Node)],t.prototype,"blackScreen",void 0),r([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Global":"Global","./SceneType":"SceneType"}],Menu:[function(e,t,o){"use strict";cc._RF.push(t,"18f1fSrdZpDcr3RSYHT7dWr","Menu");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("./SceneType"),c=e("../../Global"),a=cc._decorator,l=a.ccclass,u=a.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.blackScreen=null,t}return i(t,e),t.prototype.start=function(){var e=this;this.blackScreen.active=!0,cc.tween(this.blackScreen).delay(.3).to(c.default.config.transitionBetweenScenesTime,{opacity:0}).call(function(){return e.blackScreen.active=!1}).start()},t.prototype.onNewGameButton=function(){var e=this;cc.tween(this.blackScreen).call(function(){return e.blackScreen.active=!0}).to(c.default.config.transitionBetweenScenesTime,{opacity:255}).call(function(){return cc.director.loadScene(s.SceneType.Game)}).start()},r([u(cc.Node)],t.prototype,"blackScreen",void 0),r([l],t)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Global":"Global","./SceneType":"SceneType"}],SceneType:[function(e,t,o){"use strict";cc._RF.push(t,"240d55qxOFJ/q9Ie6k3C8S/","SceneType"),Object.defineProperty(o,"__esModule",{value:!0}),o.SceneType=void 0,function(e){e.Load="LoadScene",e.Game="GameScene",e.Menu="MenuScene"}(o.SceneType||(o.SceneType={})),cc._RF.pop()},{}],TileNode:[function(e,t,o){"use strict";cc._RF.push(t,"b290fUs6vtAJb+Do1vezaep","TileNode");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0});var s=e("../../Global"),c=cc._decorator,a=c.ccclass,l=c.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tileIcon=null,t.icons=new Array,t._animationSpeed=1,t.removeAnimation=function(){return new Promise(function(e){var o=cc.tween().by(.08*t._animationSpeed,{scale:.1}).to(.1*t._animationSpeed,{scale:0});cc.tween(t.node).then(o).call(function(){t.node.opacity=0,t.node.scale=1}).call(e).start()})},t.dropAnimation=function(){return new Promise(function(e){var o=t.tile.pos.x+t.node.position.y/t._tileSize,n=cc.v3(t.tile.pos.y*t._tileSize,-t.tile.pos.x*t._tileSize),i=.018*(s.default.config.gridSize.y-t.tile.pos.x+1);cc.tween(t.node).delay(i*t._animationSpeed).to(.2*o*t._animationSpeed,{position:n},{easing:"quadIn"}).call(function(){return t._updateZindex()}).call(e).start()})},t.updateRemoveTileAnimation=function(){return new Promise(function(e){if(t._tile.isBooster)return e();var o=cc.tween().to(.2*t._animationSpeed,{scale:1.1}).to(.1*t._animationSpeed,{scale:1}),n=cc.v3(t.tile.pos.y*t._tileSize,-t.tile.pos.x*t._tileSize);cc.tween(t.node).call(function(){t._tile.isNormal&&(t.tileIcon.spriteFrame=t.icons[t._tile.state-1]),t.node.scale=0,t.node.position=n,t.node.opacity=255,t._updateZindex()}).then(o).call(e).start()})},t.createBombAnimation=function(){return new Promise(function(e){var o=cc.tween().to(.2*t._animationSpeed,{scale:1.1}).to(.1*t._animationSpeed,{scale:1});cc.tween(t.node).call(function(){t._tile.isNormal&&(t.tileIcon.spriteFrame=t.icons[t._tile.state-1]),t.node.scale=0,t.node.opacity=255,t._updateZindex()}).then(o).call(e).start()})},t.reshuffleAnimation=function(){return new Promise(function(e){var o=cc.v3(t.tile.pos.y*t._tileSize,-t.tile.pos.x*t._tileSize);cc.tween(t.node).to(.2,{scale:0}).call(function(){t.node.position=o,t._updateZindex()}).delay(.2).to(.2,{scale:1}).call(e).start()})},t}return i(t,e),Object.defineProperty(t.prototype,"tile",{get:function(){return this._tile},enumerable:!1,configurable:!0}),t.prototype.setTileInfo=function(e){this._tile=e},t.prototype.onLoad=function(){var e=this;this._tile.isNormal&&(this.tileIcon.spriteFrame=this.icons[this._tile.state-1]),this._tile.onNoCombo.add(this.node,function(){return e.noComboAnimation()}),this._updateZindex(),this._tileSize=this.node.getContentSize().width,this._animationSpeed=s.default.config.speedAnimation},t.prototype.onClick=function(){this._tile.action()},t.prototype.updateTileIconAnimation=function(){this.tileIcon.spriteFrame=this.icons[this._tile.state-1]},t.prototype.noComboAnimation=function(){var e=this,t=.08*this._animationSpeed,o=cc.tween().to(t,{rotation:30}).to(t,{rotation:-30}),n=+(""+s.default.config.gridSize.x+s.default.config.gridSize.y+1);cc.tween(this.node).call(function(){return e.node.zIndex=n}).then(o).repeat(2).to(t,{rotation:0}).call(function(){return e._updateZindex()}).start()},t.prototype._updateZindex=function(){this.node.zIndex=-(""+this._tile.pos.x+this._tile.pos.y)},r([l(cc.Sprite)],t.prototype,"tileIcon",void 0),r([l([cc.SpriteFrame])],t.prototype,"icons",void 0),r([a],t)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Global":"Global"}],Tile:[function(e,t,o){"use strict";cc._RF.push(t,"9e276i/bzhFxo1pz48JVwqt","Tile"),Object.defineProperty(o,"__esModule",{value:!0}),o.Tile=o.typeToStrategy=o.TileState=void 0;var n,i=e("../utils/Utils"),r=e("../utils/Event"),s=e("./GridRemover");(function(e){e[e.Empty=0]="Empty",e[e.Red=1]="Red",e[e.Blue=2]="Blue",e[e.Green=3]="Green",e[e.Purple=4]="Purple",e[e.Yellow=5]="Yellow",e[e.CountColor=6]="CountColor",e[e.Bomb=7]="Bomb",e[e.Horizontal=8]="Horizontal",e[e.Vertical=9]="Vertical",e[e.Reshuffle=10]="Reshuffle",e[e.RemoveAll=11]="RemoveAll",e[e.BoosterCount=12]="BoosterCount"})(n=o.TileState||(o.TileState={})),o.typeToStrategy=new Map([[n.Horizontal,new s.HorizontalStrategy],[n.Vertical,new s.VerticalStrategy],[n.Bomb,new s.BombStrategy],[n.Reshuffle,new s.ReshuffleStrategy],[n.RemoveAll,new s.SuperBombStrategy]]);var c=function(){function e(t,o){this.onAction=new r.Event,this.onNoCombo=new r.Event,this._pos=t,this._state=o||e.getRandomTile()}return Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pos",{get:function(){return this._pos},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRemoved",{get:function(){return this._state==n.Empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNormal",{get:function(){return this._state!=n.Empty&&this._state!=n.CountColor&&this._state!=n.BoosterCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBooster",{get:function(){return this.state>n.CountColor&&this.state<n.BoosterCount},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getRemoveStrategy",{get:function(){return this.isBooster?o.typeToStrategy.get(this._state):new s.SimpleStrategy},enumerable:!1,configurable:!0}),e.getRandomTile=function(){return i.randomInteger(n.Red,n.CountColor-1)},e.prototype.action=function(){console.log("Tile dispatch action()",this),this.onAction.dispatch(this)},e.prototype.noCombo=function(){console.log("Tile dispatch noCombo()"),this.onNoCombo.dispatch()},e.prototype.remove=function(){console.log("Tile dispatch remove()"),this._state=n.Empty},e.prototype.updatePos=function(e){console.log("Tile dispatch updatePos()"),this._pos=e},e.prototype.updateState=function(){console.log("Tile dispatch updateState()"),this._state=e.getRandomTile()},e.prototype.createBomb=function(e){this._state=e},e}();o.Tile=c,cc._RF.pop()},{"../utils/Event":"Event","../utils/Utils":"Utils","./GridRemover":"GridRemover"}],Utils:[function(e,t,o){"use strict";cc._RF.push(t,"04f87O8vzVEK6Hczx6R9usv","Utils");var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],s=0,c=r.length;s<c;s++,i++)n[i]=r[s];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.chunkArray=o.shuffle=o.randomInteger=void 0,o.randomInteger=function(e,t){var o=e-.5+Math.random()*(t-e+1);return Math.round(o)},o.shuffle=function(e){for(var t,o=e.length-1;o>0;o--){var n=Math.floor(Math.random()*(o+1));t=[e[n],e[o]],e[o]=t[0],e[n]=t[1]}},o.chunkArray=function(e,t){return e.length>t?n([e.slice(0,t)],this.chunkArray(e.slice(t),t)):[e]},cc._RF.pop()},{}]},{},["Config","Global","Conditional","Grid","GridRemover","InventoryBoosters","Tile","Event","Utils","BoosterNode","ConditionalNode","EndNode","GridNode","InventoryBoostersNode","TileNode","Game","Load","Menu","SceneType"]);